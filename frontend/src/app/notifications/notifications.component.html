<section class="notifications-page container py-5">
  <div class="row justify-content-center">
    <div class="col-lg-9">
      <header class="mb-5 d-flex justify-content-between align-items-end">
        <div>
          <p class="text-primary fw-bold text-uppercase tracking-wider small mb-2">ACTIVITY FEED</p>
          <h1 class="section-title mb-0">NOTIFICATIONS</h1>
        </div>
        <div class="d-flex align-items-center gap-3">
          <button *ngIf="items().length" (click)="markAllRead()" class="btn btn-sm btn--ghost text-primary fw-bold tracking-wider" style="font-size: 0.75rem;">
            <i class="bi bi-check-all me-1"></i> MARK ALL READ
          </button>
          <div class="small text-muted fw-bold" *ngIf="items().length">
            {{ items().length }} ALERTS
          </div>
        </div>
      </header>

      <div *ngIf="loading()" class="text-center py-5"><span class="spinner-border text-primary"></span></div>
      
      <div class="status-msg error" *ngIf="errorMessage()">{{ errorMessage() }}</div>

      <div class="notifications-list d-grid gap-3" *ngIf="items().length">
        @for (item of items(); track item.id) {
          <article class="card p-4 border-0 notification-card" [class.unread]="!item.read" [class.opacity-75]="item.read">
            <div class="d-flex justify-content-between align-items-center gap-4">
              <div class="d-flex align-items-start gap-4">
                <div class="icon-wrap">
                  <i class="bi bi-lightning-charge"></i>
                </div>
                <div>
                  <p class="mb-1 message">{{ item.message }}</p>
                  <small class="text-muted uppercase tracking-wider" style="font-size: 0.7rem;">{{ item.createdAt | date:'medium' }}</small>
                </div>
              </div>
              
              <button class="btn btn-sm fw-bold px-3" 
                      [class.btn--ghost]="item.read" 
                      [class.btn-primary]="!item.read" 
                      (click)="item.read ? markUnread(item.id) : markRead(item.id)">
                <i class="bi" [class.bi-envelope-open]="item.read" [class.bi-envelope-fill]="!item.read"></i>
                <span class="ms-1">{{ item.read ? 'UNREAD' : 'READ' }}</span>
              </button>
            </div>
          </article>
        }
      </div>

      <div *ngIf="!loading() && !items().length" class="text-center py-5">
        <div class="display-1 text-muted opacity-10 mb-3"><i class="bi bi-bell-slash"></i></div>
        <p class="text-muted">No new activity signals detected.</p>
      </div>
    </div>
  </div>
</section>
